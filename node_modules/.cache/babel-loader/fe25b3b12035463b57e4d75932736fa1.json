{"ast":null,"code":"import _createForOfIteratorHelper from \"/Users/jackevans/Documents/GitHub/ULA-MScCompSci/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nimport _regeneratorRuntime from \"/Users/jackevans/Documents/GitHub/ULA-MScCompSci/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/jackevans/Documents/GitHub/ULA-MScCompSci/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/jackevans/Documents/GitHub/ULA-MScCompSci/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"/Users/jackevans/Documents/GitHub/ULA-MScCompSci/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _templateObject,\n    _this = this,\n    _jsxFileName = \"/Users/jackevans/Documents/GitHub/ULA-MScCompSci/src/components/Analyser.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport axios from 'axios';\nimport Plot from 'react-plotly.js';\nimport { ApolloClient } from 'apollo-client';\nimport { HttpLink } from 'apollo-link-http';\nimport { InMemoryCache } from 'apollo-cache-inmemory';\nimport gql from 'graphql-tag';\nimport { useQuery } from '@apollo/react-hooks';\nimport { std } from 'mathjs';\nimport { Stack, Popover, PopoverTrigger, PopoverContent, PopoverHeader, PopoverBody, PopoverArrow, PopoverCloseButton, Portal, Link, VStack, HStack, Button, ButtonGroup, useToast, Box, Heading, Center, Spacer } from \"@chakra-ui/react\";\nexport var client = new ApolloClient({\n  link: new HttpLink({\n    uri: 'https://api.thegraph.com/subgraphs/name/uniswap/uniswap-v2'\n  }),\n  fetchOptions: {\n    mode: 'no-cors'\n  },\n  cache: new InMemoryCache()\n});\n\nfunction getDayOfYear() {\n  //https://stackoverflow.com/questions/8619879/javascript-calculate-the-day-of-the-year-1-366\n  var now = new Date();\n  var start = new Date(now.getFullYear(), 0, 0);\n  var diff = now - start + (start.getTimezoneOffset() - now.getTimezoneOffset()) * 60 * 1000;\n  var oneDay = 1000 * 60 * 60 * 24;\n  var day = Math.floor(diff / oneDay);\n  return day;\n}\n\nfunction mean(arr, l) {\n  var sum = 0;\n\n  for (var i = 0; i < l; i++) {\n    sum = sum + parseFloat(arr[i]);\n  }\n\n  return sum / l;\n}\n\nfunction covariance(a1, a2, l) {\n  var sum = 0;\n\n  for (var i = 0; i < l; i++) {\n    sum = sum + (a1[i] - mean(a1, l)) * (parseFloat(a2[i]) - mean(a2, l));\n  }\n\n  return sum / (l - 1);\n}\n\nvar tokenDay_QUERY = gql(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n  query \\n  tokens($tokenAddress: Bytes!){\\n    tokenDayDatas(first:1000 orderBy: date, orderDirection: desc,\\n    where: {\\n      token: $tokenAddress\\n    }\\n    skip: 0) {\\n      id\\n      token {\\n        symbol\\n        name\\n        id\\n      }\\n      date\\n      priceUSD\\n      totalLiquidityToken\\n      totalLiquidityUSD\\n      totalLiquidityETH\\n      dailyVolumeETH\\n      dailyVolumeToken\\n      dailyVolumeUSD\\n    }\\n  }\\n  \"])));\n\nvar Analyser = function Analyser(props) {\n  _s();\n\n  var tokID = props.tokID;\n  var time1 = props.time;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      totalData = _useState2[0],\n      setData = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      loading = _useState4[0],\n      setLoading = _useState4[1];\n\n  var data = {\n    date: [],\n    prices: []\n  };\n\n  var _useState5 = useState(7),\n      _useState6 = _slicedToArray(_useState5, 2),\n      time = _useState6[0],\n      setTime = _useState6[1];\n\n  var _useState7 = useState(''),\n      _useState8 = _slicedToArray(_useState7, 2),\n      corPP = _useState8[0],\n      setCorPP = _useState8[1];\n\n  var toast = useToast();\n  useEffect(function () {\n    if (time1 === 1) {\n      if (dataL > 7) {\n        setTime(7);\n      } else {\n        setTime(dataL);\n        return toast({\n          title: \"Incomplete data\",\n          description: \"This asset is less than 7D old on Uniswap - consider researching\",\n          status: \"error\",\n          duration: 9000,\n          isClosable: true\n        });\n      }\n    }\n\n    if (time1 === 2) {\n      if (dataL > 30) {\n        setTime(30);\n      } else {\n        setTime(dataL);\n        return toast({\n          title: \"Incomplete data\",\n          description: \"This asset is less than 30D old on Uniswap - consider researching\",\n          status: \"error\",\n          duration: 9000,\n          isClosable: true\n        });\n      }\n    }\n\n    if (time1 === 3) {\n      if (365 < dataL) {\n        setTime(365);\n      } else {\n        setTime(dataL);\n      }\n    }\n  }, [time1]);\n\n  var _useQuery = useQuery(tokenDay_QUERY, {\n    variables: {\n      tokenAddress: tokID\n    }\n  }),\n      dayData = _useQuery.data,\n      refetch = _useQuery.refetch;\n\n  useEffect(function () {\n    refetch();\n  }, [tokID]);\n  var tokenName = dayData && dayData.tokenDayDatas[0].token.name;\n  var arr1 = [];\n  var arr2 = [];\n  var arr3 = [];\n  var arr4 = [];\n\n  for (var i = 0; i < time; i++) {\n    var _data = dayData && dayData.tokenDayDatas[i].dailyVolumeUSD;\n\n    arr1.push(_data);\n  }\n\n  ; //Convert epoch date to human readable date - https://stackoverflow.com/questions/34149664/how-to-convert-epoch-to-javascript-date-and-date-to-epoch/34149721\n\n  for (var j = 0; j < time; j++) {\n    var _data2 = dayData && dayData.tokenDayDatas[j].date;\n\n    if (_data2 < 10000000000) _data2 *= 1000; // convert to milliseconds (Epoch is usually expressed in seconds, but Javascript uses Milliseconds)\n\n    var data1 = _data2 + new Date().getTimezoneOffset() * -1; //for timeZone        \n\n\n    var data2 = new Date(data1);\n    arr2.push(data2);\n  }\n\n  ; //Assign data to match the length of time passed to component\n\n  for (var k = 0; k < time; k++) {\n    var _data3 = dayData && dayData.tokenDayDatas[k].totalLiquidityToken;\n\n    var dataUSD = dayData && dayData.tokenDayDatas[k].totalLiquidityUSD;\n    arr3.push(_data3);\n    arr4.push(dataUSD);\n  }\n\n  ;\n  var dataL = dayData && dayData.tokenDayDatas.length;\n\n  var handleTime2021 = function handleTime2021() {\n    var day = getDayOfYear();\n\n    if (dataL > day) {\n      setTime(day);\n    } else {\n      setTime(dataL);\n    }\n  };\n\n  var handleTimeMax = function handleTimeMax() {\n    setTime(dataL);\n  };\n\n  useEffect(function () {\n    var fetchData = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var result;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return axios('https://api.coingecko.com/api/v3/coins/ethereum/contract/' + tokID + '/market_chart/?vs_currency=usd&days=' + time);\n\n              case 2:\n                result = _context.sent;\n                setData(result.data.prices);\n                setLoading(true);\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function fetchData() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    fetchData();\n    setLoading(false);\n  }, [time]);\n\n  var _iterator = _createForOfIteratorHelper(totalData),\n      _step;\n\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var item = _step.value;\n      data.prices.push(item[1]);\n      if (item[0] < 10000000000) item[0] *= 1000; // convert to milliseconds (Epoch is usually expressed in seconds, but Javascript uses Milliseconds)\n\n      var data3 = item[0] + new Date().getTimezoneOffset() * -1; //for timeZone        \n\n      var data4 = new Date(data3);\n      data.date.push(data4);\n    } //Correlation Calculation\n\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n\n  useEffect(function () {\n    if (typeof arr3[0] !== \"undefined\") {\n      var l = data.prices.length;\n      var l2 = arr3.length;\n\n      if (l2 < l) {\n        l = l2;\n      }\n\n      var a1 = data.prices;\n      var a2 = arr3;\n\n      if (l > 0) {\n        setCorPP((covariance(a1, a2, l) / (std(a1) * std(a2)) * 100).toFixed(2) + \"%\");\n      }\n    }\n  }, [data]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(HStack, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(ButtonGroup, {\n    size: \"md\",\n    variant: \"solid\",\n    colorScheme: \"pink\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    onClick: handleTime2021,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 11\n    }\n  }, \" 2021 \"), /*#__PURE__*/React.createElement(Button, {\n    onClick: handleTimeMax,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 12\n    }\n  }, \" Max \")), /*#__PURE__*/React.createElement(Spacer, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 12\n    }\n  }), /*#__PURE__*/React.createElement(Popover, {\n    trigger: \"hover\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(PopoverTrigger, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(Heading, {\n    size: \"md\",\n    ml: \"650px\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 11\n    }\n  }, \"Correlation: \", corPP)), /*#__PURE__*/React.createElement(Portal, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(PopoverContent, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(PopoverArrow, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(PopoverHeader, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 7\n    }\n  }, \"Liquidity / price correlation for \", tokenName), /*#__PURE__*/React.createElement(PopoverCloseButton, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(PopoverBody, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    href: \"/info\",\n    colorScheme: \"blue\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 9\n    }\n  }, \"More info\")))))), /*#__PURE__*/React.createElement(Stack, {\n    spacing: 4,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Center, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Heading, {\n    size: \"md\",\n    p: \"5px\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 7\n    }\n  }, \"Daily volume and liquidity in USD for \", tokenName, \" \", ' ')), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: \"100%\",\n      height: \"100%\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 275,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Box, {\n    borderWidth: \"1px\",\n    borderRadius: \"lg\",\n    overflow: \"hidden\",\n    width: \"100%\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 276,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Plot, {\n    key: tokID,\n    displaylogo: false,\n    style: {\n      position: 'relative'\n    },\n    data: [{\n      x: arr2,\n      y: arr3,\n      type: \"line\",\n      name: \"Total Liquidity Token\",\n      yaxis: 'y2'\n    }, {\n      type: 'bar',\n      x: arr2,\n      y: arr1,\n      name: \"Daily Volume USD\"\n    }, {\n      type: 'line',\n      x: arr2,\n      y: arr4,\n      name: \"Total Liquidity USD\"\n    }],\n    layout: {\n      showlegend: true,\n      legend: {\n        x: 1,\n        xanchor: 'right',\n        y: 1.25,\n        bgcolor: 'white',\n        bordercolor: 'pink',\n        borderwidth: 2\n      },\n      width: 1000,\n      height: 500,\n      xaxis: {\n        autorange: true,\n        showgrid: false,\n        zeroline: false,\n        showline: false\n      },\n      yaxis: {\n        title: 'USD'\n      },\n      yaxis2: {\n        title: 'Total Liquidity Token',\n        titlefont: {\n          color: 'rgb(148, 103, 189)'\n        },\n        tickfont: {\n          color: 'rgb(148, 103, 189)'\n        },\n        overlaying: 'y',\n        side: 'right'\n      }\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 277,\n      columnNumber: 7\n    }\n  }))), /*#__PURE__*/React.createElement(Center, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 337,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Heading, {\n    size: \"md\",\n    p: \"5px\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 338,\n      columnNumber: 11\n    }\n  }, \"Daily price in USD for \", tokenName, \" \", ' ')), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: \"100%\",\n      height: \"100%\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 342,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Box, {\n    borderWidth: \"1px\",\n    borderRadius: \"lg\",\n    overflow: \"hidden\",\n    width: \"100%\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 343,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Plot, {\n    style: {\n      position: 'relative'\n    },\n    data: [{\n      type: 'line',\n      x: data.date,\n      y: data.prices,\n      name: \"Daily Prices\"\n    }],\n    layout: {\n      width: 1000,\n      height: 500,\n      xaxis: {\n        autorange: true,\n        showgrid: false,\n        zeroline: false,\n        showline: false\n      },\n      yaxis: {\n        tickformat: '.5f'\n      }\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 344,\n      columnNumber: 3\n    }\n  })))));\n};\n\n_s(Analyser, \"pUr5csdpY1xvExqzaduR8ZD48EI=\", false, function () {\n  return [useToast, useQuery];\n});\n\n_c = Analyser;\nexport default Analyser;\n\nvar _c;\n\n$RefreshReg$(_c, \"Analyser\");","map":{"version":3,"sources":["/Users/jackevans/Documents/GitHub/ULA-MScCompSci/src/components/Analyser.jsx"],"names":["React","useState","useEffect","axios","Plot","ApolloClient","HttpLink","InMemoryCache","gql","useQuery","std","Stack","Popover","PopoverTrigger","PopoverContent","PopoverHeader","PopoverBody","PopoverArrow","PopoverCloseButton","Portal","Link","VStack","HStack","Button","ButtonGroup","useToast","Box","Heading","Center","Spacer","client","link","uri","fetchOptions","mode","cache","getDayOfYear","now","Date","start","getFullYear","diff","getTimezoneOffset","oneDay","day","Math","floor","mean","arr","l","sum","i","parseFloat","covariance","a1","a2","tokenDay_QUERY","Analyser","props","tokID","time1","time","totalData","setData","loading","setLoading","data","date","prices","setTime","corPP","setCorPP","toast","dataL","title","description","status","duration","isClosable","variables","tokenAddress","dayData","refetch","tokenName","tokenDayDatas","token","name","arr1","arr2","arr3","arr4","dailyVolumeUSD","push","j","data1","data2","k","totalLiquidityToken","dataUSD","totalLiquidityUSD","length","handleTime2021","handleTimeMax","fetchData","result","item","data3","data4","l2","toFixed","width","height","position","x","y","type","yaxis","showlegend","legend","xanchor","bgcolor","bordercolor","borderwidth","xaxis","autorange","showgrid","zeroline","showline","yaxis2","titlefont","color","tickfont","overlaying","side","tickformat"],"mappings":"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","sourcesContent":[" import React, {useState, useEffect } from \"react\";\n\n  import axios from 'axios'\n  import Plot from 'react-plotly.js';\n  import { ApolloClient } from 'apollo-client'\n  import { HttpLink } from 'apollo-link-http'\n  import { InMemoryCache } from 'apollo-cache-inmemory'\n  import gql from 'graphql-tag'\n  import { useQuery } from '@apollo/react-hooks'\n  import {std} from 'mathjs'\n  import { Stack, \n        Popover,\n  PopoverTrigger,\n  PopoverContent,\n  PopoverHeader,\n  PopoverBody,\n  PopoverArrow,\n  PopoverCloseButton,\n  Portal,\n  Link,\n  VStack, \n  HStack, \n  Button, \n  ButtonGroup, \n  useToast, \n  Box, \n  Heading, \n  Center,\n  Spacer } from \"@chakra-ui/react\"\n\n  export const client = new ApolloClient({\n    link: new HttpLink({\n      uri: 'https://api.thegraph.com/subgraphs/name/uniswap/uniswap-v2'\n    }),\n    fetchOptions: {\n      mode: 'no-cors'\n    },\n    cache: new InMemoryCache()\n  })\n\n  function getDayOfYear(){\n    //https://stackoverflow.com/questions/8619879/javascript-calculate-the-day-of-the-year-1-366\n    var now = new Date();\n    var start = new Date(now.getFullYear(), 0, 0);\n    var diff = (now - start) + ((start.getTimezoneOffset() - now.getTimezoneOffset()) * 60 * 1000);\n    var oneDay = 1000 * 60 * 60 * 24;\n    var day = Math.floor(diff / oneDay);\n    return day;\n  }\n\n  function mean(arr, l)\n{\n    let sum = 0;\n    for(let i = 0; i < l; i++)\n        sum = sum + parseFloat(arr[i]);\n\n         \n    return sum / l;\n}\n\nfunction covariance(a1, a2, l)\n{\n    let sum = 0;\n    for(let i = 0; i < l; i++){\n        sum = sum + (a1[i] - mean(a1, l)) *\n                    (parseFloat(a2[i]) - mean(a2, l));}              \n    return sum / (l - 1);\n}\n\n\n  const tokenDay_QUERY = gql`\n  query \n  tokens($tokenAddress: Bytes!){\n    tokenDayDatas(first:1000 orderBy: date, orderDirection: desc,\n    where: {\n      token: $tokenAddress\n    }\n    skip: 0) {\n      id\n      token {\n        symbol\n        name\n        id\n      }\n      date\n      priceUSD\n      totalLiquidityToken\n      totalLiquidityUSD\n      totalLiquidityETH\n      dailyVolumeETH\n      dailyVolumeToken\n      dailyVolumeUSD\n    }\n  }\n  `\n    const Analyser = (props) => {\n\n      const tokID = props.tokID;\n      const time1 = props.time;\n\n      const [totalData, setData] = useState([]);\n      const [loading, setLoading] = useState(false);\n      let data = { date: [], prices: []};\n      \n      const [time, setTime] = useState(7)\n      const [corPP, setCorPP] = useState('')\n\n      const toast = useToast()\n        \n      useEffect(() => { if(time1===1){\n        if(dataL>7){\n      setTime(7);}\n    else{\n      setTime(dataL)\n      return (\n        toast({\n          title: \"Incomplete data\",\n          description: \"This asset is less than 7D old on Uniswap - consider researching\",\n          status: \"error\",\n          duration: 9000,\n          isClosable: true,\n        })\n        )\n    }\n      }\n       if(time1===2){\n         if(dataL>30){\n      setTime(30);}\n    else{\n      setTime(dataL)\n      return (\n        toast({\n          title: \"Incomplete data\",\n          description: \"This asset is less than 30D old on Uniswap - consider researching\",\n          status: \"error\",\n          duration: 9000,\n          isClosable: true,\n        })\n        )\n    }\n      }\n       if(time1===3){\n            if(365<dataL){\n      setTime(365);}\n    else{\n      setTime(dataL)\n    }\n      } }, [time1])\n     \n\n      const { data: dayData, refetch } = useQuery(tokenDay_QUERY,\n        { variables: {tokenAddress: tokID}});\n      useEffect(() => { refetch() }, [tokID])\n\n      const tokenName = dayData && dayData.tokenDayDatas[0].token.name\n  \n    var arr1 = [];\n    var arr2 = [];\n    var arr3 = [];\n    var arr4 = [];\n\n    for (var i = 0; i < time; i++) {\n      \n      const data = dayData && dayData.tokenDayDatas[i].dailyVolumeUSD\n     arr1.push(data)\n    };\n    \n    \n    //Convert epoch date to human readable date - https://stackoverflow.com/questions/34149664/how-to-convert-epoch-to-javascript-date-and-date-to-epoch/34149721\n    for (var j = 0; j < time; j++) {\n      let data = dayData && dayData.tokenDayDatas[j].date\n      if (data < 10000000000)\n          data *= 1000; // convert to milliseconds (Epoch is usually expressed in seconds, but Javascript uses Milliseconds)\n      var data1 = data + (new Date().getTimezoneOffset() * -1); //for timeZone        \n      var data2 = new Date(data1);\n\n      arr2.push(data2)\n    };\n\n    //Assign data to match the length of time passed to component\n    for (var k = 0; k < time; k++) {\n      let data = dayData && dayData.tokenDayDatas[k].totalLiquidityToken\n      let dataUSD = dayData && dayData.tokenDayDatas[k].totalLiquidityUSD\n      arr3.push(data)\n      arr4.push(dataUSD)\n    };\n\n    const dataL = dayData && dayData.tokenDayDatas.length;\n \n    const handleTime2021 = () => {\n        var day = getDayOfYear();\n      if(dataL>day){\n      setTime(day);}\n    else{\n      setTime(dataL)\n    }}\n\n\n        const handleTimeMax = () => {\n      setTime(dataL)\n    }\n\n  useEffect(() => { \n    const fetchData = async () => {\n    const result = await axios('https://api.coingecko.com/api/v3/coins/ethereum/contract/'\n      +tokID+'/market_chart/?vs_currency=usd&days='+time)\n    setData(result.data.prices);\n    setLoading(true)\n\n  };\n  fetchData();\n  setLoading(false)\n}, [time]);\n\n    for (const item of totalData) {\n      data.prices.push(item[1]);\n      if (item[0] < 10000000000)\n          item[0] *= 1000; // convert to milliseconds (Epoch is usually expressed in seconds, but Javascript uses Milliseconds)\n      var data3 = item[0] + (new Date().getTimezoneOffset() * -1); //for timeZone        \n      var data4 = new Date(data3);\n      data.date.push(data4);\n    }\n\n//Correlation Calculation\n  useEffect(() => { \n   if(typeof arr3[0] !==\"undefined\"){\n    var l = data.prices.length\n    var l2 = arr3.length\n    if(l2<l){\n      l=l2\n    }\n    var a1 = data.prices;\n    var a2 = arr3;\n     if(l>0){ \n\n    setCorPP((((covariance(a1,a2,l)/(std(a1)*std(a2)))*100).toFixed(2))+\"%\")\n}}\n}\n,[data])\n\n\n\n    return (\n     <div><HStack>\n          <ButtonGroup size = \"md\" variant=\"solid\" colorScheme=\"pink\">\n          <Button onClick = {handleTime2021} > 2021 </Button>\n           <Button onClick = {handleTimeMax} > Max </Button>        \n          </ButtonGroup>\n      \n           <Spacer />\n            <Popover trigger=\"hover\">\n  <PopoverTrigger >\n          <Heading size=\"md\" ml=\"650px\"\n                  >Correlation: {corPP}</Heading>\n  </PopoverTrigger>\n  <Portal>\n    <PopoverContent>\n      <PopoverArrow />\n      <PopoverHeader>Liquidity / price correlation for {tokenName}</PopoverHeader>\n      <PopoverCloseButton />\n      <PopoverBody>\n        <Link href=\"/info\" colorScheme=\"blue\">More info</Link>\n      </PopoverBody>\n    </PopoverContent>\n  </Portal>\n</Popover>\n\n</HStack>\n      <Stack spacing={4}>\n      <Center>\n      <Heading size=\"md\" p=\"5px\">\n      Daily volume and liquidity in USD for {tokenName} {' '}\n      </Heading>\n      </Center>\n      <div style={{ width: \"100%\", height: \"100%\" }}>\n      <Box borderWidth=\"1px\" borderRadius=\"lg\" overflow=\"hidden\" width=\"100%\" >\n      <Plot \n      key = {tokID}\n      displaylogo = {false}\n      style={{\n        position: 'relative'\n      }}\n      data={[\n        {\n          x: arr2,\n          y: arr3,\n          type: \"line\",\n          name: \"Total Liquidity Token\",\n          yaxis:'y2',\n        },\n        {\n          type: 'bar',\n          x: arr2, \n          y: arr1,\n          name: \"Daily Volume USD\",\n        },\n           {\n          type: 'line',\n          x: arr2,\n          y: arr4,\n          name: \"Total Liquidity USD\",\n        }\n\n        ]}\n        layout={\n          { \n            showlegend: true,\n             legend: {\n    x: 1,\n    xanchor: 'right',\n    y: 1.25,\n    bgcolor: 'white',\n    bordercolor: 'pink',\n    borderwidth: 2\n  },\n  \n  width: 1000, height: 500,\n          xaxis: {\n            autorange: true,\n            showgrid: false,\n            zeroline: false,\n            showline: false,\n          },\n           yaxis: { title: 'USD'},\n          yaxis2: {\n    title: 'Total Liquidity Token',\n    titlefont: {color: 'rgb(148, 103, 189)'},\n    tickfont: {color: 'rgb(148, 103, 189)'},\n    overlaying: 'y',\n    side: 'right'\n  }}}\n          />\n          </Box>\n               </div>\n\n     \n          <Center>\n          <Heading size=\"md\" p=\"5px\">\n      Daily price in USD for {tokenName} {' '}\n      </Heading>\n      </Center>\n      <div style={{ width: \"100%\", height: \"100%\" }}>\n      <Box borderWidth=\"1px\" borderRadius=\"lg\" overflow=\"hidden\" width=\"100%\" >\n  <Plot \n      style={{\n        position: 'relative'\n      }}\n      data={[\n        {\n          type: 'line',\n          x: data.date, \n          y: data.prices,\n          name: \"Daily Prices\"\n        }\n\n        ]}\n        layout={{ width: 1000, height: 500,\n          xaxis: {\n            autorange: true,\n            showgrid: false,\n            zeroline: false,\n            showline: false,\n          },\n          yaxis:{\n            tickformat:'.5f'\n          }}}\n          />\n          </Box>\n          </div>\n</Stack>\n</div>\n\n          );\n\n\n  };\n  export default Analyser;"]},"metadata":{},"sourceType":"module"}